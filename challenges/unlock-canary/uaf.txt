
uaf:	file format mach-o arm64

Disassembly of section __TEXT,__text:

0000000100003910 <_read_flag>:
100003910: d100c3ff    	sub	sp, sp, #48
100003914: a9027bfd    	stp	x29, x30, [sp, #32]
100003918: 910083fd    	add	x29, sp, #32
10000391c: b0000008    	adrp	x8, 0x100004000 <_read_flag+0x10>
100003920: f9401108    	ldr	x8, [x8, #32]
100003924: f90003e8    	str	x8, [sp]
100003928: f9000be0    	str	x0, [sp, #16]
10000392c: f9400100    	ldr	x0, [x8]
100003930: 90000001    	adrp	x1, 0x100003000 <_read_flag+0x20>
100003934: 91382021    	add	x1, x1, #3592
100003938: 94000131    	bl	0x100003dfc <_gets+0x100003dfc>
10000393c: f94003e8    	ldr	x8, [sp]
100003940: f9400100    	ldr	x0, [x8]
100003944: 94000128    	bl	0x100003de4 <_gets+0x100003de4>
100003948: 90000000    	adrp	x0, 0x100003000 <_read_flag+0x38>
10000394c: 91386c00    	add	x0, x0, #3611
100003950: 90000001    	adrp	x1, 0x100003000 <_read_flag+0x40>
100003954: 9138a021    	add	x1, x1, #3624
100003958: 94000117    	bl	0x100003db4 <_gets+0x100003db4>
10000395c: f90007e0    	str	x0, [sp, #8]
100003960: f94007e8    	ldr	x8, [sp, #8]
100003964: f1000108    	subs	x8, x8, #0
100003968: 1a9f07e8    	cset	w8, ne
10000396c: 370001a8    	tbnz	w8, #0, 0x1000039a0 <_read_flag+0x90>
100003970: 14000001    	b	0x100003974 <_read_flag+0x64>
100003974: f94003e8    	ldr	x8, [sp]
100003978: f9400100    	ldr	x0, [x8]
10000397c: 90000001    	adrp	x1, 0x100003000 <_read_flag+0x6c>
100003980: 9138a821    	add	x1, x1, #3626
100003984: 9400011e    	bl	0x100003dfc <_gets+0x100003dfc>
100003988: f94003e8    	ldr	x8, [sp]
10000398c: f9400100    	ldr	x0, [x8]
100003990: 94000115    	bl	0x100003de4 <_gets+0x100003de4>
100003994: 12800008    	mov	w8, #-1
100003998: b81fc3a8    	stur	w8, [x29, #-4]
10000399c: 14000024    	b	0x100003a2c <_read_flag+0x11c>
1000039a0: f94003e8    	ldr	x8, [sp]
1000039a4: f9400100    	ldr	x0, [x8]
1000039a8: 90000001    	adrp	x1, 0x100003000 <_read_flag+0x98>
1000039ac: 91391021    	add	x1, x1, #3652
1000039b0: 94000113    	bl	0x100003dfc <_gets+0x100003dfc>
1000039b4: f94003e8    	ldr	x8, [sp]
1000039b8: f9400100    	ldr	x0, [x8]
1000039bc: 9400010a    	bl	0x100003de4 <_gets+0x100003de4>
1000039c0: f9400be0    	ldr	x0, [sp, #16]
1000039c4: f94007e2    	ldr	x2, [sp, #8]
1000039c8: 528005e1    	mov	w1, #47
1000039cc: 94000100    	bl	0x100003dcc <_gets+0x100003dcc>
1000039d0: f1000008    	subs	x8, x0, #0
1000039d4: 1a9f07e8    	cset	w8, ne
1000039d8: 370001e8    	tbnz	w8, #0, 0x100003a14 <_read_flag+0x104>
1000039dc: 14000001    	b	0x1000039e0 <_read_flag+0xd0>
1000039e0: f94003e8    	ldr	x8, [sp]
1000039e4: f9400100    	ldr	x0, [x8]
1000039e8: 90000001    	adrp	x1, 0x100003000 <_read_flag+0xd8>
1000039ec: 91397021    	add	x1, x1, #3676
1000039f0: 94000103    	bl	0x100003dfc <_gets+0x100003dfc>
1000039f4: f94003e8    	ldr	x8, [sp]
1000039f8: f9400100    	ldr	x0, [x8]
1000039fc: 940000fa    	bl	0x100003de4 <_gets+0x100003de4>
100003a00: f94007e0    	ldr	x0, [sp, #8]
100003a04: 940000f5    	bl	0x100003dd8 <_gets+0x100003dd8>
100003a08: 12800008    	mov	w8, #-1
100003a0c: b81fc3a8    	stur	w8, [x29, #-4]
100003a10: 14000007    	b	0x100003a2c <_read_flag+0x11c>
100003a14: f94007e0    	ldr	x0, [sp, #8]
100003a18: 940000f0    	bl	0x100003dd8 <_gets+0x100003dd8>
100003a1c: f9400be8    	ldr	x8, [sp, #16]
100003a20: 3900bd1f    	strb	wzr, [x8, #47]
100003a24: b81fc3bf    	stur	wzr, [x29, #-4]
100003a28: 14000001    	b	0x100003a2c <_read_flag+0x11c>
100003a2c: b85fc3a0    	ldur	w0, [x29, #-4]
100003a30: a9427bfd    	ldp	x29, x30, [sp, #32]
100003a34: 9100c3ff    	add	sp, sp, #48
100003a38: d65f03c0    	ret

0000000100003a3c <_read_canary>:
100003a3c: d10183ff    	sub	sp, sp, #96
100003a40: a9057bfd    	stp	x29, x30, [sp, #80]
100003a44: 910143fd    	add	x29, sp, #80
100003a48: b0000008    	adrp	x8, 0x100004000 <_read_canary+0x10>
100003a4c: f9401108    	ldr	x8, [x8, #32]
100003a50: f90003e8    	str	x8, [sp]
100003a54: f81f03a0    	stur	x0, [x29, #-16]
100003a58: f9400100    	ldr	x0, [x8]
100003a5c: 90000001    	adrp	x1, 0x100003000 <_read_canary+0x20>
100003a60: 9139ec21    	add	x1, x1, #3707
100003a64: 940000e6    	bl	0x100003dfc <_gets+0x100003dfc>
100003a68: f94003e8    	ldr	x8, [sp]
100003a6c: f9400100    	ldr	x0, [x8]
100003a70: 940000dd    	bl	0x100003de4 <_gets+0x100003de4>
100003a74: 90000000    	adrp	x0, 0x100003000 <_read_canary+0x38>
100003a78: 913a4000    	add	x0, x0, #3728
100003a7c: 90000001    	adrp	x1, 0x100003000 <_read_canary+0x40>
100003a80: 9138a021    	add	x1, x1, #3624
100003a84: 940000cc    	bl	0x100003db4 <_gets+0x100003db4>
100003a88: f81e83a0    	stur	x0, [x29, #-24]
100003a8c: f85e83a8    	ldur	x8, [x29, #-24]
100003a90: f1000108    	subs	x8, x8, #0
100003a94: 1a9f07e8    	cset	w8, ne
100003a98: 370001a8    	tbnz	w8, #0, 0x100003acc <_read_canary+0x90>
100003a9c: 14000001    	b	0x100003aa0 <_read_canary+0x64>
100003aa0: f94003e8    	ldr	x8, [sp]
100003aa4: f9400100    	ldr	x0, [x8]
100003aa8: 90000001    	adrp	x1, 0x100003000 <_read_canary+0x6c>
100003aac: 913a7c21    	add	x1, x1, #3743
100003ab0: 940000d3    	bl	0x100003dfc <_gets+0x100003dfc>
100003ab4: f94003e8    	ldr	x8, [sp]
100003ab8: f9400100    	ldr	x0, [x8]
100003abc: 940000ca    	bl	0x100003de4 <_gets+0x100003de4>
100003ac0: 12800008    	mov	w8, #-1
100003ac4: b81fc3a8    	stur	w8, [x29, #-4]
100003ac8: 1400002d    	b	0x100003b7c <_read_canary+0x140>
100003acc: f94003e8    	ldr	x8, [sp]
100003ad0: f9400100    	ldr	x0, [x8]
100003ad4: 90000001    	adrp	x1, 0x100003000 <_read_canary+0x98>
100003ad8: 913aec21    	add	x1, x1, #3771
100003adc: 940000c8    	bl	0x100003dfc <_gets+0x100003dfc>
100003ae0: f94003e8    	ldr	x8, [sp]
100003ae4: f9400100    	ldr	x0, [x8]
100003ae8: 940000bf    	bl	0x100003de4 <_gets+0x100003de4>
100003aec: f85e83a2    	ldur	x2, [x29, #-24]
100003af0: 910023e0    	add	x0, sp, #8
100003af4: 528005e1    	mov	w1, #47
100003af8: 940000b5    	bl	0x100003dcc <_gets+0x100003dcc>
100003afc: f1000008    	subs	x8, x0, #0
100003b00: 1a9f07e8    	cset	w8, ne
100003b04: 370001e8    	tbnz	w8, #0, 0x100003b40 <_read_canary+0x104>
100003b08: 14000001    	b	0x100003b0c <_read_canary+0xd0>
100003b0c: f94003e8    	ldr	x8, [sp]
100003b10: f9400100    	ldr	x0, [x8]
100003b14: 90000001    	adrp	x1, 0x100003000 <_read_canary+0xd8>
100003b18: 913b5421    	add	x1, x1, #3797
100003b1c: 940000b8    	bl	0x100003dfc <_gets+0x100003dfc>
100003b20: f94003e8    	ldr	x8, [sp]
100003b24: f9400100    	ldr	x0, [x8]
100003b28: 940000af    	bl	0x100003de4 <_gets+0x100003de4>
100003b2c: f85e83a0    	ldur	x0, [x29, #-24]
100003b30: 940000aa    	bl	0x100003dd8 <_gets+0x100003dd8>
100003b34: 12800008    	mov	w8, #-1
100003b38: b81fc3a8    	stur	w8, [x29, #-4]
100003b3c: 14000010    	b	0x100003b7c <_read_canary+0x140>
100003b40: f85e83a0    	ldur	x0, [x29, #-24]
100003b44: 940000a5    	bl	0x100003dd8 <_gets+0x100003dd8>
100003b48: 910023e0    	add	x0, sp, #8
100003b4c: 94000097    	bl	0x100003da8 <_gets+0x100003da8>
100003b50: f94003e8    	ldr	x8, [sp]
100003b54: f85f03a9    	ldur	x9, [x29, #-16]
100003b58: b9000120    	str	w0, [x9]
100003b5c: f9400100    	ldr	x0, [x8]
100003b60: 90000001    	adrp	x1, 0x100003000 <_read_canary+0x124>
100003b64: 913bd821    	add	x1, x1, #3830
100003b68: 940000a5    	bl	0x100003dfc <_gets+0x100003dfc>
100003b6c: f94003e8    	ldr	x8, [sp]
100003b70: f9400100    	ldr	x0, [x8]
100003b74: 9400009c    	bl	0x100003de4 <_gets+0x100003de4>
100003b78: 14000001    	b	0x100003b7c <_read_canary+0x140>
100003b7c: b85fc3a0    	ldur	w0, [x29, #-4]
100003b80: a9457bfd    	ldp	x29, x30, [sp, #80]
100003b84: 910183ff    	add	sp, sp, #96
100003b88: d65f03c0    	ret

0000000100003b8c <_win>:
100003b8c: a9bf7bfd    	stp	x29, x30, [sp, #-16]!
100003b90: 910003fd    	mov	x29, sp
100003b94: b0000008    	adrp	x8, 0x100004000 <_win+0xc>
100003b98: f9401108    	ldr	x8, [x8, #32]
100003b9c: f9400100    	ldr	x0, [x8]
100003ba0: b0000021    	adrp	x1, 0x100008000 <_vuln>
100003ba4: 91000021    	add	x1, x1, #0
100003ba8: 94000095    	bl	0x100003dfc <_gets+0x100003dfc>
100003bac: a8c17bfd    	ldp	x29, x30, [sp], #16
100003bb0: d65f03c0    	ret

0000000100003bb4 <_vuln>:
100003bb4: d101c3ff    	sub	sp, sp, #112
100003bb8: a9067bfd    	stp	x29, x30, [sp, #96]
100003bbc: 910183fd    	add	x29, sp, #96
100003bc0: b0000008    	adrp	x8, 0x100004000 <_vuln+0x10>
100003bc4: f9401108    	ldr	x8, [x8, #32]
100003bc8: f9000be8    	str	x8, [sp, #16]
100003bcc: f9400100    	ldr	x0, [x8]
100003bd0: 90000001    	adrp	x1, 0x100003000 <_vuln+0x1c>
100003bd4: 913c5421    	add	x1, x1, #3861
100003bd8: 94000089    	bl	0x100003dfc <_gets+0x100003dfc>
100003bdc: f9400be8    	ldr	x8, [sp, #16]
100003be0: f9400100    	ldr	x0, [x8]
100003be4: 94000080    	bl	0x100003de4 <_gets+0x100003de4>
100003be8: f9400be8    	ldr	x8, [sp, #16]
100003bec: b0000029    	adrp	x9, 0x100008000 <_vuln+0x4c>
100003bf0: 9100c129    	add	x9, x9, #48
100003bf4: b9400129    	ldr	w9, [x9]
100003bf8: b81fc3a9    	stur	w9, [x29, #-4]
100003bfc: 52800029    	mov	w9, #1
100003c00: 381fb3a9    	sturb	w9, [x29, #-5]
100003c04: f9400100    	ldr	x0, [x8]
100003c08: 90000001    	adrp	x1, 0x100003000 <_vuln+0x54>
100003c0c: 913c7821    	add	x1, x1, #3870
100003c10: 9400007b    	bl	0x100003dfc <_gets+0x100003dfc>
100003c14: f9400be8    	ldr	x8, [sp, #16]
100003c18: f9400100    	ldr	x0, [x8]
100003c1c: 94000072    	bl	0x100003de4 <_gets+0x100003de4>
100003c20: 14000001    	b	0x100003c24 <_vuln+0x70>
100003c24: 385fb3a8    	ldurb	w8, [x29, #-5]
100003c28: 36000408    	tbz	w8, #0, 0x100003ca8 <_vuln+0xf4>
100003c2c: 14000001    	b	0x100003c30 <_vuln+0x7c>
100003c30: f9400be8    	ldr	x8, [sp, #16]
100003c34: f9400100    	ldr	x0, [x8]
100003c38: 90000001    	adrp	x1, 0x100003000 <_vuln+0x84>
100003c3c: 913ccc21    	add	x1, x1, #3891
100003c40: 9400006f    	bl	0x100003dfc <_gets+0x100003dfc>
100003c44: f9400be8    	ldr	x8, [sp, #16]
100003c48: f9400100    	ldr	x0, [x8]
100003c4c: 94000066    	bl	0x100003de4 <_gets+0x100003de4>
100003c50: 91006fe0    	add	x0, sp, #27
100003c54: f90007e0    	str	x0, [sp, #8]
100003c58: 94000066    	bl	0x100003df0 <_gets+0x100003df0>
100003c5c: f94007e8    	ldr	x8, [sp, #8]
100003c60: f9400be9    	ldr	x9, [sp, #16]
100003c64: f9400120    	ldr	x0, [x9]
100003c68: 910003e9    	mov	x9, sp
100003c6c: f9000128    	str	x8, [x9]
100003c70: 90000001    	adrp	x1, 0x100003000 <_vuln+0xbc>
100003c74: 913d2421    	add	x1, x1, #3913
100003c78: 94000061    	bl	0x100003dfc <_gets+0x100003dfc>
100003c7c: f9400be8    	ldr	x8, [sp, #16]
100003c80: f9400100    	ldr	x0, [x8]
100003c84: 94000058    	bl	0x100003de4 <_gets+0x100003de4>
100003c88: f94007e1    	ldr	x1, [sp, #8]
100003c8c: f9400be8    	ldr	x8, [sp, #16]
100003c90: f9400100    	ldr	x0, [x8]
100003c94: 9400005a    	bl	0x100003dfc <_gets+0x100003dfc>
100003c98: f9400be8    	ldr	x8, [sp, #16]
100003c9c: f9400100    	ldr	x0, [x8]
100003ca0: 94000051    	bl	0x100003de4 <_gets+0x100003de4>
100003ca4: 17ffffe0    	b	0x100003c24 <_vuln+0x70>
100003ca8: b85fc3a8    	ldur	w8, [x29, #-4]
100003cac: b0000029    	adrp	x9, 0x100008000 <_vuln+0x10c>
100003cb0: 9100c129    	add	x9, x9, #48
100003cb4: b9400129    	ldr	w9, [x9]
100003cb8: 6b090108    	subs	w8, w8, w9
100003cbc: 1a9f17e8    	cset	w8, eq
100003cc0: 37000188    	tbnz	w8, #0, 0x100003cf0 <_vuln+0x13c>
100003cc4: 14000001    	b	0x100003cc8 <_vuln+0x114>
100003cc8: f9400be8    	ldr	x8, [sp, #16]
100003ccc: f9400100    	ldr	x0, [x8]
100003cd0: 90000001    	adrp	x1, 0x100003000 <_vuln+0x11c>
100003cd4: 913d6c21    	add	x1, x1, #3931
100003cd8: 94000049    	bl	0x100003dfc <_gets+0x100003dfc>
100003cdc: f9400be8    	ldr	x8, [sp, #16]
100003ce0: f9400100    	ldr	x0, [x8]
100003ce4: 94000040    	bl	0x100003de4 <_gets+0x100003de4>
100003ce8: 52800020    	mov	w0, #1
100003cec: 94000035    	bl	0x100003dc0 <_gets+0x100003dc0>
100003cf0: a9467bfd    	ldp	x29, x30, [sp, #96]
100003cf4: 9101c3ff    	add	sp, sp, #112
100003cf8: d65f03c0    	ret

0000000100003cfc <_main>:
100003cfc: d10183ff    	sub	sp, sp, #96
100003d00: a9057bfd    	stp	x29, x30, [sp, #80]
100003d04: 910143fd    	add	x29, sp, #80
100003d08: b0000008    	adrp	x8, 0x100004000 <_main+0x10>
100003d0c: f9401108    	ldr	x8, [x8, #32]
100003d10: f9000be8    	str	x8, [sp, #16]
100003d14: f9400100    	ldr	x0, [x8]
100003d18: 90000001    	adrp	x1, 0x100003000 <_main+0x1c>
100003d1c: 913ddc21    	add	x1, x1, #3959
100003d20: 94000037    	bl	0x100003dfc <_gets+0x100003dfc>
100003d24: f9400be8    	ldr	x8, [sp, #16]
100003d28: f9400100    	ldr	x0, [x8]
100003d2c: 9400002e    	bl	0x100003de4 <_gets+0x100003de4>
100003d30: b0000020    	adrp	x0, 0x100008000 <_main+0x48>
100003d34: 9100c000    	add	x0, x0, #48
100003d38: f90007e0    	str	x0, [sp, #8]
100003d3c: 97ffff40    	bl	0x100003a3c <_read_canary>
100003d40: f94007e8    	ldr	x8, [sp, #8]
100003d44: f9400be9    	ldr	x9, [sp, #16]
100003d48: f9400120    	ldr	x0, [x9]
100003d4c: b9400109    	ldr	w9, [x8]
100003d50: aa0903e8    	mov	x8, x9
100003d54: 910003e9    	mov	x9, sp
100003d58: f9000128    	str	x8, [x9]
100003d5c: 90000001    	adrp	x1, 0x100003000 <_main+0x60>
100003d60: 913e4c21    	add	x1, x1, #3987
100003d64: 94000026    	bl	0x100003dfc <_gets+0x100003dfc>
100003d68: 910083e0    	add	x0, sp, #32
100003d6c: f9000fe0    	str	x0, [sp, #24]
100003d70: 97fffee8    	bl	0x100003910 <_read_flag>
100003d74: f9400be9    	ldr	x9, [sp, #16]
100003d78: f9400fe8    	ldr	x8, [sp, #24]
100003d7c: f9400120    	ldr	x0, [x9]
100003d80: 910003e9    	mov	x9, sp
100003d84: f9000128    	str	x8, [x9]
100003d88: 90000001    	adrp	x1, 0x100003000 <_main+0x8c>
100003d8c: 913e7821    	add	x1, x1, #3998
100003d90: 9400001b    	bl	0x100003dfc <_gets+0x100003dfc>
100003d94: 97ffff88    	bl	0x100003bb4 <_vuln>
100003d98: 52800000    	mov	w0, #0
100003d9c: a9457bfd    	ldp	x29, x30, [sp, #80]
100003da0: 910183ff    	add	sp, sp, #96
100003da4: d65f03c0    	ret

Disassembly of section __TEXT,__stubs:

0000000100003da8 <__stubs>:
100003da8: b0000010    	adrp	x16, 0x100004000 <__stubs+0x4>
100003dac: f9400210    	ldr	x16, [x16]
100003db0: d61f0200    	br	x16
100003db4: b0000010    	adrp	x16, 0x100004000 <__stubs+0x10>
100003db8: f9400610    	ldr	x16, [x16, #8]
100003dbc: d61f0200    	br	x16
100003dc0: b0000010    	adrp	x16, 0x100004000 <__stubs+0x1c>
100003dc4: f9400a10    	ldr	x16, [x16, #16]
100003dc8: d61f0200    	br	x16
100003dcc: b0000010    	adrp	x16, 0x100004000 <__stubs+0x28>
100003dd0: f9400e10    	ldr	x16, [x16, #24]
100003dd4: d61f0200    	br	x16
100003dd8: b0000010    	adrp	x16, 0x100004000 <__stubs+0x34>
100003ddc: f9401610    	ldr	x16, [x16, #40]
100003de0: d61f0200    	br	x16
100003de4: b0000010    	adrp	x16, 0x100004000 <__stubs+0x40>
100003de8: f9401a10    	ldr	x16, [x16, #48]
100003dec: d61f0200    	br	x16
100003df0: b0000010    	adrp	x16, 0x100004000 <__stubs+0x4c>
100003df4: f9401e10    	ldr	x16, [x16, #56]
100003df8: d61f0200    	br	x16
100003dfc: b0000010    	adrp	x16, 0x100004000 <__stubs+0x58>
100003e00: f9402210    	ldr	x16, [x16, #64]
100003e04: d61f0200    	br	x16
